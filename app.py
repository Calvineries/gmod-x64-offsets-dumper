from pymem import Pymem, process, pattern

print("...")
def get_sig(module_name, _pattern):
    if module_name != 'all':
        memory = Pymem("gmod.exe")
        module = process.module_from_name(memory.process_handle, module_name)
        result = pattern.pattern_scan_module(memory.process_handle, module, _pattern)
        result += 0 - module.lpBaseOfDll
        return result
    else:
        memory = Pymem("gmod.exe")
        result = pattern.pattern_scan_all(memory.process_handle, _pattern, return_multiple=True)
        #temp fix
        size = len(result) - 1
        return result[size]


try:
    dwLocalPlayer = get_sig('client.dll', rb'......\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFF\xFF\xFF\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\xFF\xFF\xFF\xFF')
except Exception as err:
    pass
try:
    dwEntityList = get_sig('client.dll', rb'......\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00......\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00.....\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00.....\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00\x00....\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00.....\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00..\x00\x00\x00\x00\x00\x00.....\x7F\x00\x00.....\x7F\x00\x00')
except Exception as err:
    pass
try:
    dwViewMatrix = get_sig('engine.dll', rb'......\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00......\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00......\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00......\x00\x00......\x00\x00..\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00......\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00')    
except Exception as err:
    pass
try:
    dwForceJump = get_sig('client.dll', rb'\x04\x00\x00\x00\x00\x00\x00\x00....\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00.')
except Exception as err:
    pass
try:
    mat_fullbright = get_sig('materialsystem.dll', rb'\x20...\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40....\x7F\x00\x00\x40....\x7F\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x90....\x7F\x00\x00\x1A....\x7F\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\xF0....\x7F\x00\x00\xB0....\x7F\x00\x00\xF0....\x7F\x00\x00......\x00\x00\x02\x00\x00\x00\xB0...\xB0...\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40....\x7F\x00\x00\xD0....\x7F\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\xA0....\x7F\x00\x00\x1A....\x7F\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\xF0....\x7F\x00\x00\x40')
except Exception as err:
    pass
try:
    steam_id_pointer = get_sig('all', rb'\x53\x54\x45\x41\x4D\x5F\x30\x3A.\x3A.........\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xF9\x3E\x77\x13\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00')
    memory = Pymem("gmod.exe")
    client_dll = process.module_from_name(memory.process_handle, 'client.dll').lpBaseOfDll
    base = memory.read_longlong(client_dll + dwLocalPlayer)
    localplayer_pointer = steam_id_pointer - base
except Exception as err:
    pass


try:
    print("dwLocalPlayer:", hex(dwLocalPlayer))
except Exception as err:
    pass
try:
    print("dwEntityList:", hex(dwEntityList))
except Exception as err:
    pass
try:
    print("dwViewMatrix:", hex(dwViewMatrix))
except Exception as err:
    pass
try:
    print("dwForceJump:", hex(dwForceJump))
except Exception as err:
    pass
try:
    print("mat_fullbright:", hex(mat_fullbright))
except Exception as err:
    pass
try:
    if localplayer_pointer < 0x9000:
        print("\nLocalPlayer Pointers:")
        print("- SteamID:", hex(localplayer_pointer))
        print("- Playername:", hex(localplayer_pointer - 0x84))
        print("- Crosshair:", hex(localplayer_pointer - 0xC8))
    else:
        print("\nYou must be connected to a server to get the pointers.")
except Exception as err:
    print("\nYou must be connected to a server to get the pointers.")
    pass

